identity:
  name: get_transaction
  author: alai-sudo
  label:
    en_US: Get Transaction Details
    zh_Hans: 获取交易详情
    ja_JP: 取引詳細を取得
    fr_FR: Obtenir les détails de la transaction
    es_ES: Obtener detalles de transacción
    pt_BR: Obter detalhes da transação
    ko_KR: 거래 상세 조회
description:
  human:
    en_US: Retrieve detailed information about a specific transaction, including status, counterparty, and tracking info.
    zh_Hans: 获取特定交易的详细信息，包括状态、交易对手和追踪信息。
    ja_JP: 特定の取引の詳細情報（ステータス、取引相手、追跡情報など）を取得。
    fr_FR: Récupérer les informations détaillées d'une transaction spécifique, y compris le statut et les informations de suivi.
    es_ES: Obtener información detallada de una transacción específica, incluyendo estado e información de seguimiento.
    pt_BR: Obter informações detalhadas de uma transação específica, incluindo status e informações de rastreamento.
    ko_KR: 특정 거래의 상세 정보(상태, 거래 상대방, 추적 정보 등)를 조회합니다.
  llm: Fetches complete details for a specific transaction by ID, including status, counterparty info, and tracking details.
parameters:
  - name: account_id
    type: string
    required: false
    label:
      en_US: Account ID
      zh_Hans: 账户 ID
      ja_JP: 口座 ID
      fr_FR: ID du compte
      es_ES: ID de cuenta
      pt_BR: ID da conta
      ko_KR: 계좌 ID
    human_description:
      en_US: The Mercury account ID (optional, improves query performance if known)
      zh_Hans: Mercury 账户 ID（可选，如已知可提高查询性能）
      ja_JP: Mercury 口座 ID（オプション、既知の場合はクエリ性能が向上）
      fr_FR: L'ID du compte Mercury (optionnel, améliore les performances si connu)
      es_ES: ID de la cuenta Mercury (opcional, mejora el rendimiento si se conoce)
      pt_BR: ID da conta Mercury (opcional, melhora a performance se conhecido)
      ko_KR: Mercury 계좌 ID (선택사항, 알고 있으면 조회 성능 향상)
    llm_description: Mercury account ID (UUID format, optional)
    form: llm
  - name: transaction_id
    type: string
    required: true
    label:
      en_US: Transaction ID
      zh_Hans: 交易 ID
      ja_JP: 取引 ID
      fr_FR: ID de transaction
      es_ES: ID de transacción
      pt_BR: ID da transação
      ko_KR: 거래 ID
    human_description:
      en_US: The unique identifier of the transaction
      zh_Hans: 交易的唯一标识符
      ja_JP: 取引の一意識別子
      fr_FR: L'identifiant unique de la transaction
      es_ES: El identificador único de la transacción
      pt_BR: O identificador único da transação
      ko_KR: 거래의 고유 식별자
    llm_description: Mercury transaction ID (e.g., txn_xxx)
    form: llm

output_schema:
  type: object
  properties:
    # Core identification
    id:
      type: string
      description: Transaction ID
    account_id:
      type: string
      description: Mercury account ID

    # Status (enum: pending | sent | cancelled | failed | reversed | blocked)
    status:
      type: string
      enum: [pending, sent, cancelled, failed, reversed, blocked]
      description: "Transaction status: pending (processing), sent (completed), cancelled (voided), failed (error), reversed (refunded), blocked (compliance hold)"

    # Financial data
    amount:
      type: number
      description: Transaction amount (negative for debits, positive for credits)
    kind:
      type: string
      description: "Transaction kind: externalTransfer, internalTransfer, cardTransaction, fee, etc."

    # Counterparty info
    counterparty_id:
      type: string
      description: Counterparty ID
    counterparty_name:
      type: string
      description: Counterparty name
    counterparty_nickname:
      type: string
      description: User-defined nickname for counterparty

    # Descriptions and notes
    bank_description:
      type: string
      description: Bank-provided description
    note:
      type: string
      description: Internal note (only visible to account holders)
    external_memo:
      type: string
      description: External memo (visible to counterparty)

    # Timestamps
    created_at:
      type: string
      format: date-time
      description: When the transaction was created (ISO 8601)
    posted_at:
      type: string
      format: date-time
      description: When the transaction was posted (ISO 8601)
    estimated_delivery_date:
      type: string
      format: date-time
      description: Estimated delivery date for pending transfers
    failed_at:
      type: string
      format: date-time
      description: When the transaction failed (if status is 'failed')

    # Tracking and reference
    tracking_number:
      type: string
      description: Tracking number for wire transfers
    check_number:
      type: string
      description: Check number (for check transactions)
    fee_id:
      type: string
      description: Associated fee transaction ID

    # Category data
    category_id:
      type: string
      description: Category ID for expense classification
    category_name:
      type: string
      description: Category name for expense classification

    # Compliance and metadata
    compliant_with_receipt_policy:
      type: boolean
      description: Whether transaction has required receipt attached
    dashboard_link:
      type: string
      description: Direct link to transaction in Mercury dashboard
    credit_account_period_id:
      type: string
      description: Credit account period ID (for credit transactions)

    # Currency exchange info
    currency_exchange:
      type: object
      description: Currency exchange details (for international transfers)
      properties:
        converted_amount:
          type: number
          description: Amount in target currency
        exchange_rate:
          type: number
          description: Exchange rate used
        from_currency:
          type: string
          description: Source currency code
        to_currency:
          type: string
          description: Target currency code
        fee:
          type: number
          description: Exchange fee

    # Routing details
    routing_details:
      type: object
      description: ACH/Electronic routing information
      properties:
        account_number:
          type: string
          description: Account number
        routing_number:
          type: string
          description: Routing number
        bank_name:
          type: string
          description: Bank name
        account_type:
          type: string
          description: Account type (checking, savings)

    domestic_wire_details:
      type: object
      description: Domestic wire routing information
      properties:
        account_number:
          type: string
        routing_number:
          type: string
        address:
          type: object

    international_wire_details:
      type: object
      description: International wire routing information
      properties:
        swift_code:
          type: string
        iban:
          type: string
        bank_name:
          type: string
        country:
          type: string

    # Card info
    credit_card_id:
      type: string
      description: Credit card ID (match with get_cards for cardholder details)
    credit_card_email:
      type: string
      description: Credit card holder email
    credit_card_payment_method:
      type: string
      description: Payment method (contactless, chip, online, etc.)
    credit_card_last_four:
      type: string
      description: Last 4 digits of credit card
    debit_card_id:
      type: string
      description: Debit card ID (match with get_cards for cardholder details)
    debit_card_last_four:
      type: string
      description: Last 4 digits of debit card

    # Attachments
    attachments:
      type: array
      description: Transaction attachments (receipts, check images, etc.)
      items:
        type: object
        properties:
          id:
            type: string
            description: Attachment ID
          file_name:
            type: string
            description: File name
          url:
            type: string
            description: Download URL
          attachment_type:
            type: string
            enum: [checkImage, receipt, other]
            description: Type of attachment

extra:
  python:
    source: tools/get_transaction.py
